<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Newport</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }
        .step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }
        .step h3 {
            color: #667eea;
            margin: 0 0 15px 0;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
            word-break: break-all;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 600;
            text-align: center;
            margin: 15px 0;
            transition: transform 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: #f8f9fa;
            color: #667eea;
            border: 2px solid #667eea;
        }
        .btn-secondary:hover {
            background: #667eea;
            color: white;
        }
        .status {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .qr-section {
            text-align: center;
            margin: 30px 0;
        }
        .qr-code {
            margin: 20px 0;
        }
        .qr-code img {
            max-width: 200px;
            border-radius: 10px;
        }
        .device-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h1>
        
        <div class="status success" id="serverStatus">
            ‚úÖ –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8000
        </div>
        
        <div class="step">
            <h3>üåê –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞</h3>
            <p>–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:</p>
            <div class="code-block">python -m http.server 8000</div>
        </div>
        
        <div class="step">
            <h3>üìç –®–∞–≥ 2: –í–∞—à IP –∞–¥—Ä–µ—Å</h3>
            <p>–ù–∞–π–¥–∏—Ç–µ IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ WiFi –∞–¥–∞–ø—Ç–µ—Ä–∞:</p>
            <div class="code-block" id="ipAddress">
                –û–ø—Ä–µ–¥–µ–ª—è–µ–º IP –∞–¥—Ä–µ—Å...
            </div>
            <div id="manualIpSection" style="display: none;">
                <p><strong>–†—É—á–Ω–æ–π –≤–≤–æ–¥ IP –∞–¥—Ä–µ—Å–∞:</strong></p>
                <input type="text" id="manualIp" placeholder="192.168.1.100" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
                <button onclick="setManualIP()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç IP</button>
            </div>
            <div class="status warning">
                <strong>–í–∞–∂–Ω–æ:</strong> –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Ç–æ–π –∂–µ WiFi —Å–µ—Ç–∏!
            </div>
        </div>
        
        <div class="step">
            <h3>üì± –®–∞–≥ 3: –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ</h3>
            <p>–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</p>
            <div class="code-block" id="mobileUrl">
                http://[–í–ê–®_IP]:8000
            </div>
            <a href="#" class="btn" id="openMobile">
                üì± –û—Ç–∫—Ä—ã—Ç—å –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
            </a>
        </div>
        
        <div class="qr-section">
            <h3>üì∑ –ò–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR –∫–æ–¥</h3>
            <div class="qr-code" id="qrCode">
                <p>–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR –∫–æ–¥...</p>
            </div>
        </div>
        
        <div class="step">
            <h3>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏</h3>
            <a href="universal_link_handler.html?invite=THZ5RZ9FD3D9DR01" class="btn">
                üîó –¢–µ—Å—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
            </a>
            <a href="invite_web.html?invite=THZ5RZ9FD3D9DR01" class="btn btn-secondary">
                üåê –¢–µ—Å—Ç –≤–µ–±-–≤–µ—Ä—Å–∏–∏
            </a>
            <a href="test_invite_system.html" class="btn btn-secondary">
                üß™ –°–æ–∑–¥–∞—Ç—å –∏–Ω–≤–∞–π—Ç
            </a>
        </div>
        
        <div class="device-info" id="deviceInfo">
            –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ...
        </div>
    </div>

    <script>
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        function getDeviceInfo() {
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                screenSize: `${screen.width}x${screen.height}`,
                windowSize: `${window.innerWidth}x${window.innerHeight}`,
                isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
                isIOS: /iPad|iPhone|iPod/.test(navigator.userAgent),
                isAndroid: /Android/.test(navigator.userAgent)
            };
            
            return info;
        }

        // –ü–æ–ø—ã—Ç–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π IP
        function getLocalIP() {
            return new Promise((resolve, reject) => {
                const pc = new RTCPeerConnection({
                    iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
                });
                
                pc.createDataChannel("");
                pc.createOffer().then(offer => pc.setLocalDescription(offer));
                
                pc.onicecandidate = (ice) => {
                    if (!ice || !ice.candidate || !ice.candidate.candidate) return;
                    
                    const candidateStr = ice.candidate.candidate;
                    const match = candidateStr.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
                    
                    if (match && match[1]) {
                        const myIP = match[1];
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π IP (–Ω–µ 127.0.0.1)
                        if (myIP !== '127.0.0.1' && !myIP.startsWith('169.254')) {
                            pc.onicecandidate = null;
                            resolve(myIP);
                        }
                    }
                };
                
                setTimeout(() => {
                    reject(new Error('Timeout'));
                }, 3000);
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        async function updatePageInfo() {
            const deviceInfo = getDeviceInfo();
            const deviceInfoEl = document.getElementById('deviceInfo');
            
            deviceInfoEl.innerHTML = `
                <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:</strong><br>
                –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${deviceInfo.platform}<br>
                –ú–æ–±–∏–ª—å–Ω–æ–µ: ${deviceInfo.isMobile ? '–î–∞' : '–ù–µ—Ç'}<br>
                iOS: ${deviceInfo.isIOS ? '–î–∞' : '–ù–µ—Ç'}<br>
                Android: ${deviceInfo.isAndroid ? '–î–∞' : '–ù–µ—Ç'}<br>
                –†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞: ${deviceInfo.screenSize}<br>
                –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞: ${deviceInfo.windowSize}<br>
                –Ø–∑—ã–∫: ${deviceInfo.language}
            `;
            
            // –ü–æ–ø—ã—Ç–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å IP
            try {
                const ip = await getLocalIP();
                const ipEl = document.getElementById('ipAddress');
                const mobileUrlEl = document.getElementById('mobileUrl');
                const openMobileEl = document.getElementById('openMobile');
                const qrCodeEl = document.getElementById('qrCode');
                
                const serverUrl = `http://${ip}:8000`;
                const testUrl = `${serverUrl}/universal_link_handler.html?invite=THZ5RZ9FD3D9DR01`;
                
                ipEl.textContent = ip;
                mobileUrlEl.textContent = serverUrl;
                openMobileEl.href = serverUrl;
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–∞
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(testUrl)}`;
                qrCodeEl.innerHTML = `
                    <img src="${qrUrl}" alt="QR Code">
                    <p><small>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</small></p>
                `;
                
            } catch (error) {
                console.error('Could not determine IP:', error);
                document.getElementById('ipAddress').innerHTML = `
                    <strong>–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å IP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</strong><br>
                    –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É: <code>ipconfig</code> (Windows) –∏–ª–∏ <code>ifconfig</code> (Mac/Linux)
                `;
                document.getElementById('mobileUrl').textContent = '–í–≤–µ–¥–∏—Ç–µ IP –∞–¥—Ä–µ—Å –Ω–∏–∂–µ';
                document.getElementById('manualIpSection').style.display = 'block';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
        function checkServerStatus() {
            fetch('/')
                .then(response => {
                    if (response.ok) {
                        document.getElementById('serverStatus').innerHTML = '‚úÖ –í–µ–±-—Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç';
                        document.getElementById('serverStatus').className = 'status success';
                    }
                })
                .catch(error => {
                    document.getElementById('serverStatus').innerHTML = '‚ùå –í–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω';
                    document.getElementById('serverStatus').className = 'status warning';
                });
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ IP
        function setManualIP() {
            const manualIp = document.getElementById('manualIp').value.trim();
            if (!manualIp) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ IP –∞–¥—Ä–µ—Å');
                return;
            }
            
            // –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è IP
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
            if (!ipPattern.test(manualIp)) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP –∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100)');
                return;
            }
            
            updateWithIP(manualIp);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å IP –∞–¥—Ä–µ—Å–æ–º
        function updateWithIP(ip) {
            const ipEl = document.getElementById('ipAddress');
            const mobileUrlEl = document.getElementById('mobileUrl');
            const openMobileEl = document.getElementById('openMobile');
            const qrCodeEl = document.getElementById('qrCode');
            
            const serverUrl = `http://${ip}:8000`;
            const testUrl = `${serverUrl}/universal_link_handler.html?invite=THZ5RZ9FD3D9DR01`;
            
            ipEl.innerHTML = `<strong>${ip}</strong>`;
            mobileUrlEl.textContent = serverUrl;
            openMobileEl.href = serverUrl;
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–∞
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(testUrl)}`;
            qrCodeEl.innerHTML = `
                <img src="${qrUrl}" alt="QR Code">
                <p><small>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</small></p>
            `;
            
            // –°–∫—Ä—ã—Ç—å —Å–µ–∫—Ü–∏—é —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
            document.getElementById('manualIpSection').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            updatePageInfo();
            checkServerStatus();
        });
    </script>
</body>
</html> 