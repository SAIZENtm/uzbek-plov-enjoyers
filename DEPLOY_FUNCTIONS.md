# üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Cloud Functions –¥–ª—è Newport

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **Node.js** –≤–µ—Ä—Å–∏–∏ 18 –∏–ª–∏ –≤—ã—à–µ
2. **Firebase CLI** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ
3. **–ü—Ä–æ–µ–∫—Ç Firebase** –Ω–∞—Å—Ç—Ä–æ–µ–Ω

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Firebase CLI

```bash
npm install -g firebase-tools
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```bash
firebase login
```

## üìÅ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)

```bash
firebase init functions
```

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd functions
npm install
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π:
```bash
firebase deploy --only functions
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:
```bash
firebase deploy --only functions:testPushNotification
```

## üìù –°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ

1. **`testPushNotification`** - HTTP —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. **`sendPushNotification`** - Callable —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ push –∏–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
3. **`onNotificationCreate`** - Trigger —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. **`onServiceRequestUpdate`** - Trigger —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏
5. **`createNotification`** - HTTP —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
6. **`createTestNotification`** - HTTP —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Firebase Console:
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Firebase Console
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç (newport-23a19)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Functions"
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `test_push.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í—Å—Ç–∞–≤—å—Ç–µ FCM —Ç–æ–∫–µ–Ω –∏–∑ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `test_notification_system.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞ CORS:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `testPushNotification` —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `test_push.html`

### –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
```bash
firebase login --reauth
```

### –û—à–∏–±–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
firebase functions:log

# –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à
npm run clean
firebase deploy --only functions --force
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
firebase functions:log
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
firebase functions:log --only testPushNotification
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Ñ—É–Ω–∫—Ü–∏–π:

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –†–∞–∑–≤–µ—Ä–Ω—É—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
   ```bash
   firebase deploy --only functions
   ```
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## üìû URL —Ñ—É–Ω–∫—Ü–∏–π

–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∞—à–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å–∞–º:

- **testPushNotification**: `https://us-central1-newport-23a19.cloudfunctions.net/testPushNotification`
- **createNotification**: `https://us-central1-newport-23a19.cloudfunctions.net/createNotification`
- **createTestNotification**: `https://us-central1-newport-23a19.cloudfunctions.net/createTestNotification`

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–º–∞–Ω–¥–æ–π `firebase deploy --only functions`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ `test_push.html`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ 