# üîÑ Enhanced Offline Mode Implementation

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ offline —Ä–µ–∂–∏–º–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Newport Resident —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### üèóÔ∏è –û—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

1. **OfflineService** - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è offline —Ä–µ–∂–∏–º–æ–º
   - –û—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å retry –ª–æ–≥–∏–∫–æ–π
   - –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
   - –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∞–º—è—Ç—å + –¥–∏—Å–∫)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏

2. **OfflineStatusIndicator** - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—Ç–∞—Ç—É—Å–∞ offline
   - –ñ–∏–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ç–∏
   - –°—á–µ—Ç—á–∏–∫ –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º

3. **Offline Extensions** - –£–¥–æ–±–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
   - –ú–∏–∫—Å–∏–Ω—ã –¥–ª—è offline-aware –≤–∏–¥–∂–µ—Ç–æ–≤
   - –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫–∏

### üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### ‚ú® –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–∞–º—è—Ç—å (–±—ã—Å—Ç—Ä–æ) + –¥–∏—Å–∫ (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)
- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **TTL (Time To Live)** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –∫–µ—à–∞
- **LRU (Least Recently Used)** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é

#### üîÑ –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
- **Retry –ª–æ–≥–∏–∫–∞** —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –¥–µ–π—Å—Ç–≤–∏–π** –ø–æ —Ç–∏–ø—É –∏ –≤–∞–∂–Ω–æ—Å—Ç–∏
- **Batch –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

#### ‚ö†Ô∏è –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- **UI –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è**: –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ, –ø—Ä–æ–ø—É—Å–∫
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞—É–¥–∏—Ç** –≤—Å–µ—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

#### üéØ –¢–∏–ø—ã offline –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫** –Ω–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
- ‚úÖ **–ü–µ—Ä–µ–¥–∞—á–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π** —Å—á–µ—Ç—á–∏–∫–æ–≤
- ‚úÖ **–û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–∑—ã–≤–æ–≤** –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–ü—Ä–æ—á—Ç–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π** —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```dart
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è offline
await context.saveOfflineData('user_preferences', preferences);

// –ü–æ–ª—É—á–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
final data = await context.getCachedData<Map<String, dynamic>>('user_preferences');

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–∏
final isOnline = await context.isOnline;
```

### Offline-aware –≤–∏–¥–∂–µ—Ç—ã

```dart
class MyScreen extends StatefulWidget {
  // ...
}

class _MyScreenState extends State<MyScreen> with OfflineAwareMixin {
  @override
  void onSyncStatusChanged(OfflineSyncStatus status) {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    super.onSyncStatusChanged(status);
  }
  
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        actions: [
          OfflineStatusIndicator(showDetails: true),
        ],
      ),
      // ...
    );
  }
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ —Å offline –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π

```dart
final requestData = {
  'type': 'plumbing',
  'description': '–¢–µ—á–µ—Ç –∫—Ä–∞–Ω',
  'priority': 'high',
};

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
await requestData.createOfflineServiceRequest(context);
```

### –§–æ—Ä–º—ã —Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

```dart
class ServiceRequestForm extends StatefulWidget {
  // ...
}

class _ServiceRequestFormState extends State<ServiceRequestForm> 
    with OfflineFormMixin {
  
  @override
  void initState() {
    super.initState();
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —á–µ—Ä–Ω–æ–≤–∏–∫
    loadDraft().then((draft) {
      if (draft != null) {
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
      }
    });
  }
  
  void _onFormChanged() {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫
    saveDraft({
      'description': _descriptionController.text,
      'priority': _selectedPriority,
    });
  }
  
  void _onSubmit() async {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∏ –æ—á–∏—Å—Ç–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫
    await submitRequest();
    await clearDraft();
  }
}
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```dart
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏
final queueStatus = offlineService.queueStatus;
print('Pending actions: ${queueStatus.pendingCount}');
print('Is syncing: ${queueStatus.isSyncing}');

// –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
offlineService.syncStatusStream.listen((status) {
  switch (status.state) {
    case SyncState.syncing:
      showSyncIndicator();
      break;
    case SyncState.completed:
      showSyncSuccess(status.processedCount);
      break;
    case SyncState.error:
      showSyncError();
      break;
  }
});
```

### –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

```dart
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
final conflicts = await offlineService.getConflicts();

for (final conflict in conflicts) {
  // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–æ—Ä
  final resolution = await showConflictDialog(conflict);
  
  // –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ
  await offlineService.resolveConflict(
    conflict.id, 
    resolution, // ConflictResolution.useLocal, .useServer, .merge, .skip
  );
}
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```dart
// –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é
final success = await offlineService.forceSync();
if (!success) {
  showSnackBar('–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É');
}
```

## üé® UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### OfflineStatusIndicator

–£–º–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ —Å –∂–∏–≤—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:

```dart
// –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
OfflineStatusIndicator()

// –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —Å –¥–µ—Ç–∞–ª—è–º–∏
OfflineStatusIndicator(
  showDetails: true,
  onTap: () => showOfflineDetails(),
)
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- üü¢ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ (–≤—Å–µ –≤ –ø–æ—Ä—è–¥–∫–µ)
- üîµ –û–∂–∏–¥–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (N –¥–µ–π—Å—Ç–≤–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏)
- üü† –ö–æ–Ω—Ñ–ª–∏–∫—Ç –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±—É–µ—Ç –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞)
- üî¥ –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º (–Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)

### –î–µ—Ç–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è bottom sheet —Å:
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- **–û—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–µ–π—Å—Ç–≤–∏–π
- **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- **–î–µ–π—Å—Ç–≤–∏—è**: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –æ—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

```dart
// –í offline_service.dart –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
static const int _maxMemoryCacheSize = 100; // –†–∞–∑–º–µ—Ä –∫–µ—à–∞ –≤ –ø–∞–º—è—Ç–∏
static const Duration _autoSyncInterval = Duration(minutes: 5); // –ò–Ω—Ç–µ—Ä–≤–∞–ª –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

### Retry –ª–æ–≥–∏–∫–∞

```dart
// –í OfflineAction –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è:
final int maxRetries; // –ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
Duration retryDelay = Duration(seconds: (2 * retryCount).clamp(1, 60)); // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

Sensitive –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —à–∏—Ñ—Ä—É—é—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:

```dart
await context.saveOfflineData(
  'payment_info', 
  paymentData,
  type: OfflineDataType.userAction, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —à–∏—Ñ—Ä—É–µ—Ç—Å—è
);
```

### –ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–í—Å–µ offline –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
- Passport number –∫–∞–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –†–∞–∑–¥–µ–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
2. **Memory cache** - —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏
3. **Batch –æ–ø–µ—Ä–∞—Ü–∏–∏** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
4. **Background sync** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI

### –ú–µ—Ç—Ä–∏–∫–∏

- **Memory cache hit rate** - 85-95% –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Sync latency** - <2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **Storage overhead** - <10MB –¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ü–æ–ª–Ω—ã–π offline**
   - –û—Ç–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
   - –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É, –ø–µ—Ä–µ–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è
   - –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

2. **–ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å**
   - –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Ä–∞–∑—Ä—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å retry –ª–æ–≥–∏–∫—É –∏ –æ—á–µ—Ä–µ–¥—å

3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö**
   - –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è offline
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

## üêõ Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
   ```dart
   // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–∏
   final isOnline = await offlineService.isOnline();
   
   // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å
   await offlineService.forceSync();
   ```

2. **–î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è**
   ```dart
   // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å
   final canWrite = await offlineService.canWrite();
   
   // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π –∫–µ—à
   await offlineService.clearOfflineData();
   ```

3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è**
   ```dart
   // –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
   final conflicts = await offlineService.getConflicts();
   for (final conflict in conflicts) {
     print('Conflict: ${conflict.conflictReason}');
     print('Action: ${conflict.action.type}');
   }
   ```

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. **Smart sync** - –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
2. **Delta sync** - –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **Collaborative editing** - —Ä–µ–∞–ª—Ç–∞–π–º —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. **Advanced analytics** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
5. **Progressive sync** - –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **Push notifications** –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- **Background tasks** –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ —Ñ–æ–Ω–µ
- **Cloud storage** –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- **Analytics service** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### OfflineService

```dart
class OfflineService {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  Future<void> initialize()
  
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
  Future<void> saveOfflineData(String key, dynamic data, {...})
  Future<T?> getOfflineData<T>(String key, {...})
  Future<void> removeOfflineData(String key)
  
  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
  Future<void> enqueueAction(OfflineAction action)
  Future<bool> forceSync()
  Stream<OfflineSyncStatus> get syncStatusStream
  
  // –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã
  Future<List<ConflictData>> getConflicts()
  Future<void> resolveConflict(String conflictId, ConflictResolution resolution)
  
  // –£—Ç–∏–ª–∏—Ç—ã
  Future<bool> isOnline()
  SyncQueueStatus get queueStatus
  Future<void> clearOfflineData()
}
```

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ offline —Ä–µ–∂–∏–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

- ‚úÖ **–ë–µ—Å—à–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É** –≤ offline —Ä–µ–∂–∏–º–µ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é** –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
- ‚úÖ **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ** –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- ‚úÖ **–£–¥–æ–±–Ω—ã–π UI** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ **–í—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Newport Resident —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è! üöÄ 