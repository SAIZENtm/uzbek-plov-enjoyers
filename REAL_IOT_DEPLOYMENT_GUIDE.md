# üè† –†–ï–ê–õ–¨–ù–´–ô –£–ú–ù–´–ô –î–û–ú NEWPORT - –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ

## üéØ **–û–ë–ó–û–† –°–ò–°–¢–ï–ú–´**

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å **–†–ï–ê–õ–¨–ù–ê–Ø** —Å–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –¥–æ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º —á–µ—Ä–µ–∑ Arduino ESP8266 –∏ Firebase Realtime Database.

## üìã **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´**

```
üì± Newport App (Flutter)
    ‚ÜïÔ∏è Firebase Realtime Database  
    ‚ÜïÔ∏è Arduino ESP8266 + Sensors/Relays
    ‚ÜïÔ∏è –§–∏–∑–∏—á–µ—Å–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Å–≤–µ—Ç, –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä, –¥–∞—Ç—á–∏–∫–∏)
```

## üîß **–ù–ï–û–ë–•–û–î–ò–ú–û–ï –û–ë–û–†–£–î–û–í–ê–ù–ò–ï**

### **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **ESP8266 NodeMCU** (–º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä)
- **LCD –¥–∏—Å–ø–ª–µ–π 16x2** (—Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤)
- **DHT22 –¥–∞—Ç—á–∏–∫** (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–≤–ª–∞–∂–Ω–æ—Å—Ç—å)
- **2x —Ä–µ–ª–µ –º–æ–¥—É–ª—è** (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ–º/–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–æ–º)
- **–†–µ–∑–∏—Å—Ç–æ—Ä—ã, –ø—Ä–æ–≤–æ–¥–∞, breadboard**

### **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- –ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è 5V/3.3V
- –ö–æ—Ä–ø—É—Å –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- Ethernet –∫–∞–±–µ–ª—å (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ WiFi)

## üöÄ **–®–ê–ì 1: –ù–ê–°–¢–†–û–ô–ö–ê FIREBASE**

### 1.1 –í–∫–ª—é—á–µ–Ω–∏–µ Firebase Realtime Database

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç `newport-23a19`
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Realtime Database**
4. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"**
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: `europe-west1`)
6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```json
{
  "rules": {
    "apartments": {
      "$blockId": {
        "$apartmentNumber": {
          "devices": {
            ".read": "auth != null",
            ".write": "auth != null"
          }
        }
      }
    }
  }
}
```

### 1.2 –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. –í –ø—Ä–æ–µ–∫—Ç–µ Firebase –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞**
2. –í–∫–ª–∞–¥–∫–∞ **"–û–±—â–∏–µ"** ‚Üí –Ω–∞–π–¥–∏—Ç–µ **Web API Key**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - **API Key**: `AIzaSy...`
   - **Database URL**: `https://newport-23a19-default-rtdb.firebaseio.com`

## üîå **–®–ê–ì 2: –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï ARDUINO**

### 2.1 –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```
ESP8266 NodeMCU    ‚Üí    –ö–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
D0, D1, D2, D3,    ‚Üí    LCD –¥–∏—Å–ø–ª–µ–π 16x2
D4, D5                  (RS, EN, D4-D7)
D6                 ‚Üí    –†–µ–ª–µ #1 (–æ—Å–≤–µ—â–µ–Ω–∏–µ)
D7                 ‚Üí    –†–µ–ª–µ #2 (–∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä) 
D8                 ‚Üí    DHT22 (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–≤–ª–∞–∂–Ω–æ—Å—Ç—å)
3.3V               ‚Üí    –ü–∏—Ç–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤
GND                ‚Üí    –û–±—â–∏–π –ø—Ä–æ–≤–æ–¥
```

### 2.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ Arduino

–í Arduino IDE —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
```
- ESP8266WiFi
- Firebase ESP Client (v4.4.14+)
- DHT sensor library
- LiquidCrystal
```

### 2.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∞ Arduino

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `arduino_newport_iot.ino`
2. –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```cpp
// Firebase –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
#define API_KEY "–í–ê–®_API_KEY_–ò–ó_FIREBASE"
#define DATABASE_URL "https://newport-23a19-default-rtdb.firebaseio.com"

// WiFi –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  
#define WIFI_SSID "–í–ê–®_WIFI_SSID"
#define WIFI_PASSWORD "–í–ê–®_WIFI_–ü–ê–†–û–õ–¨"

// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã
#define BLOCK_ID "D BLOK"      // –í–∞—à –±–ª–æ–∫
#define APARTMENT_NUM "101"    // –í–∞—à –Ω–æ–º–µ—Ä –∫–≤–∞—Ä—Ç–∏—Ä—ã
```

3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ ESP8266

## üì± **–®–ê–ì 3: –û–ë–ù–û–í–õ–ï–ù–ò–ï FLUTTER –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø**

### 3.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
flutter pub get
```

### 3.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:

```yaml
dependencies:
  firebase_database: ^11.1.4  # ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
  network_info_plus: ^6.0.0   # ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ  
  wifi_scan: ^0.4.1            # ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
```

### 3.3 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

```dart
// –í main.dart –∏–ª–∏ initializeApp()
final iotService = getIt<IoTDeviceService>();
await iotService.initialize();

final smartHomeService = getIt<SmartHomeService>();  
await smartHomeService.initialize();
```

## üî• **–®–ê–ì 4: –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´**

### 4.1 –ó–∞–ø—É—Å–∫ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
flutter run
```

### 4.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–£–º–Ω—ã–π –¥–æ–º"** 
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å**: –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è **–†–ï–ê–õ–¨–ù–´–ï** —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤–º–µ—Å—Ç–æ –¥–µ–º–æ
4. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –≤–∫–ª—é—á–µ–Ω–∏–µ —Å–≤–µ—Ç–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã

### 4.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Arduino

–û—Ç–∫—Ä–æ–π—Ç–µ Serial Monitor –≤ Arduino IDE (115200 baud):
```
======= NEWPORT IoT DEVICE STARTING =======
WiFi connected! 
IP address: 192.168.1.100
Firebase authentication successful
Device registered successfully  
Temperature: 24.5¬∞C, Humidity: 65%
Status updated in Firebase
Light ON
AC OFF
```

## üêõ **–£–°–¢–†–ê–ù–ï–ù–ò–ï –ù–ï–ü–û–õ–ê–î–û–ö**

### –ü—Ä–æ–±–ª–µ–º–∞: "No real IoT devices found"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Arduino –∫ WiFi
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Firebase API –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –≤ Firebase: `apartments/D BLOK/101/devices/`

### –ü—Ä–æ–±–ª–µ–º–∞: "Failed to control real IoT device"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Serial Monitor Arduino –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Firebase –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –∑–∞–ø–∏—Å—å
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –∫–æ–º–∞–Ω–¥: `/commands/light`, `/commands/ac`

### –ü—Ä–æ–±–ª–µ–º–∞: "Device not responding"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Arduino
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–æ–¥–æ–≤
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é Ping –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

## üìä **–ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ê–ù–ê–õ–ò–¢–ò–ö–ê**

### Firebase Console
–û—Ç–∫—Ä–æ–π—Ç–µ Firebase Realtime Database –∏ —É–≤–∏–¥–∏—Ç–µ:
```json
{
  "apartments": {
    "D BLOK": {
      "101": {
        "devices": {
          "esp8266_living_room_01": {
            "name": "ESP8266 Multi-Sensor",
            "type": "multi_sensor", 
            "status": {
              "temperature": 24.5,
              "humidity": 65,
              "lightStatus": "on",
              "acStatus": "off",
              "isOnline": true,
              "lastHeartbeat": "2024-01-10T15:30:00Z"
            },
            "commands": {
              "light": "on",
              "ac": "off", 
              "targetTemperature": 23
            }
          }
        }
      }
    }
  }
}
```

### –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Newport
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤**: —Ä–µ–∞–ª—å–Ω—ã–µ vs –¥–µ–º–æ
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω
- **–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥**: –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ —É–ø—Ä–∞–≤–ª—è–ª
- **–î–∞—Ç—á–∏–∫–∏**: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üîí **–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨**

### Firebase Rules (–ø—Ä–æ–¥–∞–∫—à–Ω)
```json
{
  "rules": {
    "apartments": {
      "$blockId": {
        "$apartmentNumber": {
          "devices": {
            ".read": "auth != null && (
              exists(/userProfiles/ + auth.uid) ||
              exists(/users/ + $blockId + /apartments/ + $apartmentNumber)
            )",
            ".write": "auth != null && (
              exists(/userProfiles/ + auth.uid) ||  
              exists(/users/ + $blockId + /apartments/ + $apartmentNumber)
            )"
          }
        }
      }
    }
  }
}
```

## üöÄ **–†–ê–°–®–ò–†–ï–ù–ò–ï –°–ò–°–¢–ï–ú–´**

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:
1. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –Ω–æ–≤—ã–µ —Ä–µ–ª–µ/–¥–∞—Ç—á–∏–∫–∏** –∫ ESP8266
2. **–û–±–Ω–æ–≤–∏—Ç–µ Arduino –∫–æ–¥** (–¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –ø–∏–Ω—ã/—Ñ—É–Ω–∫—Ü–∏–∏)
3. **–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤** –≤ Flutter (SmartDeviceType)
4. **–û–±–Ω–æ–≤–∏—Ç–µ UI** –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
- ‚úÖ **–û—Å–≤–µ—â–µ–Ω–∏–µ** (–≤–∫–ª/–≤—ã–∫–ª)
- ‚úÖ **–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä** (–≤–∫–ª/–≤—ã–∫–ª, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞)
- ‚úÖ **–î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏**
- üîÑ **–ñ–∞–ª—é–∑–∏/—à—Ç–æ—Ä—ã** (–æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å)
- üîÑ **–£–º–Ω—ã–µ —Ä–æ–∑–µ—Ç–∫–∏** (–≤–∫–ª/–≤—ã–∫–ª)
- üîÑ **–î–∞—Ç—á–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è** (–¥–µ—Ç–µ–∫—Ç–æ—Ä)
- üîÑ **–ö–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è** (–ø—Ä–æ—Å–º–æ—Ç—Ä)

---

## üéâ **–ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!** 

–£ –≤–∞—Å —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å **–†–ï–ê–õ–¨–ù–ê–Ø** —Å–∏—Å—Ç–µ–º–∞ —É–º–Ω–æ–≥–æ –¥–æ–º–∞ Newport —Å:

‚úÖ **–§–∏–∑–∏—á–µ—Å–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏** —á–µ—Ä–µ–∑ Arduino  
‚úÖ **–†–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏** —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–µ–º –∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–æ–º**  
‚úÖ **Firebase –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏  
‚úÖ **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º UI** –≤ —Å—Ç–∏–ª–µ Tesla/Apple  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞**  

**–ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö –º–æ–∫–æ–≤! –¢–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã–º –¥–æ–º–æ–º! üè†‚ö°** 