# üì∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≥—Ä—É–∑–∫–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

## üö® –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–í –≤–∞—à–∏—Ö –ø—Ä–∞–≤–∏–ª–∞—Ö Firebase Storage –±—ã–ª–∞ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** –≤ —Ä–∞—Å—á–µ—Ç–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤:

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—ç—Ç–æ ~10GB –≤–º–µ—Å—Ç–æ 5MB!)
request.resource.size < 5 * 1080 * 1920

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ 5MB)
request.resource.size < 5 * 1024 * 1024
```

## üõ†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

–Ø –æ–±–Ω–æ–≤–∏–ª —Ñ–∞–π–ª `storage.rules` —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏:

1. **–£–≤–µ–ª–∏—á–∏–ª –ª–∏–º–∏—Ç** —Å 5MB –¥–æ 10MB –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **–†–∞–∑—Ä–µ—à–∏–ª –ø—É–±–ª–∏—á–Ω–æ–µ —á—Ç–µ–Ω–∏–µ** –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Å–∞–π—Ç–µ
3. **–î–æ–±–∞–≤–∏–ª –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üöÄ –ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Firebase Console (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Firebase Console](https://console.firebase.google.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **newport-23a19**
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** ‚Üí **Rules**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `storage.rules` –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
5. –ù–∞–∂–º–∏—Ç–µ **Publish**

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Firebase CLI

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js —Å https://nodejs.org
# –ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Firebase CLI
npm install -g firebase-tools

# –í–æ–π–¥–∏—Ç–µ –≤ Firebase
firebase login

# –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞
firebase deploy --only storage
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `test_photo_upload.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:
   - –ê–Ω–æ–Ω–∏–º–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
   - –ó–∞–≥—Ä—É–∑–∫—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
   - –ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ `service_requests/{id}/images/`
- ‚úÖ URL –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —á—Ç–µ–Ω–∏—è

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** –Ω–∞ –æ—à–∏–±–∫–∏
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª** `test_photo_upload.html`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Firebase Console**:
   - Storage ‚Üí Files (–¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã)
   - Authentication ‚Üí Users (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `storage/unauthorized` | –°—Ç–∞—Ä—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã | –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ |
| `storage/quota-exceeded` | –ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –≤ Console |
| `auth/operation-not-allowed` | –ê–Ω–æ–Ω–∏–º–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ | –í–∫–ª—é—á–∏—Ç–µ –≤ Authentication ‚Üí Sign-in methods |

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É CLI, –ø—Ä–æ—Å—Ç–æ:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `storage.rules`
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ Firebase Console ‚Üí Storage ‚Üí Rules
3. –ù–∞–∂–º–∏—Ç–µ **Publish**
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å –ø–æ–º–æ—â—å—é `test_photo_upload.html`

## üì± –î–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ Firebase Storage
2. URL –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ Firestore
3. –í–µ–±-—Å–∞–π—Ç —Å–º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ URL

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### CORS –¥–ª—è –≤–µ–±-–¥–æ—Å—Ç—É–ø–∞

–ï—Å–ª–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ CORS:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª cors.json
[
  {
    "origin": ["*"],
    "method": ["GET"],
    "maxAgeSeconds": 3600
  }
]

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
gsutil cors set cors.json gs://newport-23a19.firebasestorage.app
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] –ü—Ä–∞–≤–∏–ª–∞ Storage —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—à–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É  
- [ ] –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤–∏–¥–Ω—ã –≤ Firebase Console ‚Üí Storage
- [ ] –ê–Ω–æ–Ω–∏–º–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
- [ ] –í–µ–±-—Å–∞–π—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ URL

---

üí° **–°–æ–≤–µ—Ç**: –ù–∞—á–Ω–∏—Ç–µ —Å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ - –æ–Ω –ø–æ–∫–∞–∂–µ—Ç —Ç–æ—á–Ω—É—é –æ—à–∏–±–∫—É –∏ –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É! 